{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ProgramPlanCreated",
  "description": "Event emitted when a user creates a new training program plan",
  "type": "object",
  "required": [
    "schema_version",
    "event_type",
    "client_generated_id",
    "user_id",
    "timestamp",
    "source_service",
    "data"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "const": "1.0.0"
    },
    "event_type": {
      "type": "string",
      "const": "program.plan.created"
    },
    "client_generated_id": {
      "type": "string",
      "format": "uuid"
    },
    "user_id": {
      "type": "string",
      "format": "uuid"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    },
    "source_service": {
      "type": "string",
      "enum": ["frontend", "notification-service", "ai-agent-service"]
    },
    "data": {
      "type": "object",
      "required": ["plan_id", "start_date", "comp_date", "workouts"],
      "properties": {
        "plan_id": {
          "type": "string",
          "format": "uuid"
        },
        "start_date": {
          "type": "string",
          "format": "date"
        },
        "comp_date": {
          "type": "string",
          "format": "date"
        },
        "workouts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "date": {"type": "string", "format": "date"},
              "exercises": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "exercise_name": {"type": "string"},
                    "sets": {"type": "integer"},
                    "reps": {"type": "string"},
                    "weight": {"type": "string"},
                    "rpe": {"type": "number"}
                  }
                }
              },
              "notes": {"type": "string"}
            }
          }
        },
        "reminders": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {"type": "string", "enum": ["cron", "offset"]},
              "value": {"type": "string"},
              "channel": {"type": "string", "enum": ["email", "push", "sms"]}
            }
          }
        }
      }
    }
  },
  "example": {
    "schema_version": "1.0.0",
    "event_type": "program.plan.created",
    "client_generated_id": "550e8400-e29b-41d4-a716-446655440030",
    "user_id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
    "timestamp": "2025-11-05T10:00:00Z",
    "source_service": "frontend",
    "data": {
      "plan_id": "d1e2f3a4-b5c6-7890-defg-123456789012",
      "start_date": "2025-11-10",
      "comp_date": "2026-02-15",
      "workouts": [
        {
          "date": "2025-11-10",
          "exercises": [
            {
              "exercise_name": "Squat",
              "sets": 5,
              "reps": "5",
              "weight": "150kg",
              "rpe": 7.5
            },
            {
              "exercise_name": "Bench Press",
              "sets": 5,
              "reps": "5",
              "weight": "100kg",
              "rpe": 7.0
            }
          ],
          "notes": "Week 1 Day 1 - Focus on form"
        }
      ],
      "reminders": [
        {
          "type": "offset",
          "value": "1h",
          "channel": "push"
        }
      ]
    }
  }
}

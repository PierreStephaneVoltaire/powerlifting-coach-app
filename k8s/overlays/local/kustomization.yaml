apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: powerlifting-coach

resources:
  - ../../base

patchesStrategicMerge:
  - local-patches.yaml

configMapGenerator:
  - name: app-config
    literals:
      - ENVIRONMENT=local
      - DATABASE_URL=postgresql://app_user:powerlifting123@postgres:5432/powerlifting_app
      - REDIS_URL=valkey:6379
      - RABBITMQ_URL=amqp://admin:changeme123@rabbitmq:5672/
      - APP_URL=http://localhost:8080

images:
  - name: auth-service
    newName: powerlifting-coach/auth-service
    newTag: local
  - name: user-service
    newName: powerlifting-coach/user-service
    newTag: local
  - name: video-service
    newName: powerlifting-coach/video-service
    newTag: local
  - name: settings-service
    newName: powerlifting-coach/settings-service
    newTag: local
  - name: program-service
    newName: powerlifting-coach/program-service
    newTag: local
  - name: coach-service
    newName: powerlifting-coach/coach-service
    newTag: local
  - name: notification-service
    newName: powerlifting-coach/notification-service
    newTag: local
  - name: frontend
    newName: powerlifting-coach/frontend
    newTag: local

commonLabels:
  environment: local

replicas:
  - name: postgres
    count: 1
  - name: valkey
    count: 1
  - name: rabbitmq
    count: 1